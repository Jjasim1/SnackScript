SnackScript {
  Program = Statement+

  Statement = "ğŸ¥˜" id "(" Params ")" Block                        --function
            | "ğŸ¥˜" id Block                                       --simplefunction
            | "ğŸ¥" id "in" Exp ("..." | "..<") Exp Block          --forloop
            | "ğŸ¥" ListOf<id, ","> "in" Primary Block             --foreach
            | "ğŸ¤" Exp Block                                      --while
            | "ğŸ§" Exp Block ElseIfPart*  ElsePart?               --if
            | "ğŸ½ï¸" ExpList                                        --print
            | "ğŸ«—" Exp?                                           --return
            | "ğŸ«–"                                                --break
            | "ğŸ¥¡" id "=" CollectionLit                           --collection
            | "ğŸ±" id "=" "{" CompExp "}"                         --comprehension
            | VarDecl
            | Primary "=" Exp                                      --assign
            | Primary "+=" Exp                                     --addassign
            | Primary ("++" | "--")                        --bump
            | Primary_call                             --call

  Block = ":" Statement+ ";"

  MethodDecl = "ğŸ¥˜" id "(" Params ")" ":" Block

  Type = "ğŸ§ˆ"         --bool
         | "ğŸ³"        --int
         | "ğŸ³"        --float
         | "ğŸ"        --string
         | "ğŸ¥®"        --void
         | "ğŸš"        --any

  Params = NonemptyListOf<ParamItem, ",">

  ParamItem = Type id

  ForInit = VarDecl "," (id | numeral) RelOp (id | numeral) "," id "++"

  ElseIfPart = "ğŸ°" Exp Block

  ElsePart = "ğŸ‚" Block

  ExpList = NonemptyListOf<(Exp | stringLit), ",">


  VarDecl = Type id "=" Exp

  CompExp = id ":" Exp "for" ListOf<id, ","> "in" id

  CollectionLit = ArrayLit
                | DictLit

  ArrayLit = "[" ListOf<ArrayItem, ","> "]"

  DictLit = "{" ListOf<DictItem, ","> "}"

  ArrayItem = TupleItem
            | SimpleItem

  TupleItem = "(" ListOf<Exp, ","> ")"
  SimpleItem = Exp

  DictItem = Exp ":" Exp

  Exp = Exp1 RelOp Exp1                                       --binary
      | Exp1

  Exp1 = Exp1 AddOp Term                                      --binary
       | Term

  Term = Term MulOp Factor                                    --binary
       | Factor

  Factor = "not" Factor                                         --neg
         | Primary

  Primary = Primary "(" ListOf<Exp, ","> ")"                  --call
          | BoolLit                                           --bool
          | numeral                                           --num
          | stringLit                                         --string
          | DottedId                                          --var
          | id                                                --id
          | "(" Exp ")"                                       --paren

  BoolLit = "ğŸ¥—" | "ğŸ²"

  RelOp = "<=" | ">=" | "==" | "!=" | "<" | ">"
  AddOp = "+" | "-"
  MulOp = "*" | "/" | "%"

  stringLit = "\"" (~"\"" any)* "\""

  numeral = digit+ ("." digit+)?

  id = ~keyword (letter | "_") (alnum | "_" | "*")*
  ids = id (", " id)*

  DottedId = Primary ("." | "?.") id

  keyword = "in" | "for"

  NewLine = "\n"+
  IndentMarker = &(space+)  // Just a positive lookahead, not consuming input
  DedentMarker = &(space*)  // Just a positive lookahead, not consuming input

  space += comment | multicomment
  comment = "ğŸ¦" (~"\n" any)*                               --comment
  multicomment = "ğŸ¨" (~"ğŸ¨" any)* "ğŸ¨"                      --multicomment
}